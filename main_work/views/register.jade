extends layout

block register
  div(style='text-align: center').container
    script(type='text/javascript').
      function checkForm(form)
      {
        var valid = true;
        if (form.username.value.length == 0) {
          document.getElementById('username_notice').removeAttribute('hidden');
          valid = false;
        }
        if (form.password.value.length == 0) {
          document.getElementById('password_notice').removeAttribute('hidden');
          valid = false;
        }
        if (document.getElementById('confirmed_pwd').value != document.getElementById('password').value) {
          document.getElementById('confirmed_notice').removeAttribute('hidden');
          valid = false;
        }
        if (form.nickname.value.length == 0) {
          document.getElementById('nickname_notice').removeAttribute('hidden');
          valid = false;
        }
        var re = /^(([^<>()[\]\\.,;:\s@\"]+(\.[^<>()[\]\\.,;:\s@\"]+)*)|(\".+\"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/;
        var email_val = form.email.value;
        console.log(re.test(email_val));
        if (re.test(email_val) == false) {
          document.getElementById('email_notice').removeAttribute('hidden');
          valid = false;
        }
        if(!form.terms.checked) {
          alert("請先同意使用條款");
          form.terms.focus();
          valid = false;
        }
        console.log(valid);
        return valid;
      }
    div(style='height: 100%; width: 70%; margin: 0 auto')
      form(id='register_form', method='POST', action='/register', onsubmit='return checkForm(this);')
        div.register_box
          h1 成為預言王
        div.register_box
          table(style='width: 100%')
            tbody
              tr.spaceUnder
                td
                  div.form-group
                    input(type='text', id='username', name='username', placeholder='帳號').form-control.form-control-lg
                    p(id='username_notice', hidden).text-danger 請填入帳號！
                td
                  div.form-group
                    input(type='text', id='nickname', name='nickname', placeholder='暱稱').form-control.form-control-lg
                    p(id='nickname_notice', hidden).text-danger 請輸入暱稱！
              tr.spaceUnder
                td
                  div.form-group
                    input(type='password', id='password', name='password', placeholder='密碼').form-control.form-control-lg
                    p(id='password_notice', hidden).text-danger 請輸入密碼！
                td
                  div.form-group
                    select(id='gender', name='gender').form-control.form-control-lg
                      option 男
                      option 女
              tr.spaceUnder
                td
                  div.form-group
                    input(type='password', id='confirmed_pwd', name='confirmed-pwd', placeholder='確認密碼').form-control.form-control-lg
                    p(id='confirmed_notice', hidden).text-danger 與密碼不符！
                td
                  div.form-group
                    input(type='text', id='email', name='email', placeholder='信箱').form-control.form-control-lg
                    p(id='email_notice', hidden).text-danger 請輸入合法的信箱！
        div.register_box
          input(type='checkbox', name='terms', value='').form-check-input
          我同意&nbsp;
          a(href='/') 服務條款
          &nbsp;、&nbsp;
          a(href='/') 停權管理規章
          &nbsp;和&nbsp;
          a(href='/') 隱私政策
          &nbsp;，
          br
          同時也了解若我未滿20歲，我的法定代理人或監護人必須代表我完整檢閱和同意使用條款。
        div.register_box
          button(type='submit', style='width: 50%; float: right').btn.btn-lg.btn-dark 下一步
